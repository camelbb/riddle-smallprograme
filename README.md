# 谜语游戏项目

这是一个完整的谜语游戏解决方案，包含三个相互关联但独立部署的组件：API服务、数据爬虫和微信小程序前端。通过这三个组件的协作，实现了谜语内容的采集、存储、管理和用户交互的完整流程。

## 项目组件

### 1. riddle-api
基于Lumen框架开发的RESTful API服务，为微信小程序提供谜语数据接口支持。

**主要功能：**
- 提供谜语类型列表查询接口
- 根据类型ID获取谜语列表
- 谜语详情查询
- 随机获取指定类型的谜语（排行榜接口）
- 支持数据分页获取

**技术栈：**
- PHP 8.0+
- Lumen框架
- MySQL数据库
- Docker容器化支持

### 2. riddle-spider
Python开发的数据爬虫程序，用于自动从互联网爬取谜语内容并存储到MySQL数据库。

**主要功能：**
- 按页爬取谜语网站内容
- 自动提取谜语、类型和谜底信息
- 数据去重校验
- 与API服务共享数据库，实现数据自动更新
- 遵循爬虫道德，设置合理的爬取间隔

**技术栈：**
- Python
- 数据爬取相关库
- MySQL数据库操作

### 3. riddle-wechat-smallprogram
专为儿童设计的微信小程序前端，提供友好的用户界面和互动体验。

**主要功能：**
- 多种谜语主题选择（动物、植物、水果等）
- 随机获取谜语题目
- 答案验证和反馈
- 得分记录
- 题目切换
- 分享功能

**技术栈：**
- 微信小程序原生开发
- 微信小程序API
- WXML/WXSS/JS

## 安装与部署

### API服务部署

1. 克隆项目并安装依赖：
```bash
cd riddle-api
composer install
```

2. 配置环境变量：
复制 `.env.example` 为 `.env` 并修改数据库配置

3. 导入数据库：
```bash
mysql -u username -p database_name < riddle.sql
```

4. 启动服务（开发环境）：
```bash
php -S localhost:8000 -t public
```

5. 或使用Docker部署（推荐生产环境）：
```bash
docker-compose -f docker-compose.yml up -d
```

### 爬虫部署

1. 安装依赖：
```bash
cd riddle-spider
pip install -r requirements.txt
```

2. 配置数据库连接：
修改 `riddle_spider.py` 中的数据库连接参数

3. 运行爬虫：
```bash
python riddle_spider.py
```

### 微信小程序部署

1. 在微信开发者工具中导入项目
2. 替换 `project.config.json` 中的 `appid` 为您自己的小程序AppID
3. 确保API服务可用
4. 编译并运行项目

## 工作流程

1. **数据采集**：爬虫程序从网络获取谜语数据并存入MySQL数据库
2. **数据服务**：API服务读取数据库内容，提供标准化的接口
3. **用户交互**：微信小程序通过API获取数据，提供用户猜谜体验

## 注意事项

1. 确保三个项目的数据库配置一致，特别是爬虫和API服务需要使用同一数据库
2. API服务默认运行在 `http://localhost:8000`，如需修改，请同步更新微信小程序中的接口地址
3. 部署到生产环境时，请确保配置正确的网络和安全设置
4. 爬虫程序设计有延时机制，请不要随意修改以避免对目标网站造成过大压力

## 技术支持

如有任何问题或建议，请联系项目维护者。